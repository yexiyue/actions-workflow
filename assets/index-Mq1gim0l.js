import{bH as l,bI as b,bJ as w,bK as A,bL as R}from"./index-5pNbV5yM.js";import{c as L,v as T,D as q}from"./index-cW0ZioI2.js";function J(o,i){var c=L(i==null?void 0:i.client);T(o,q.Mutation);var p=l.useState({called:!1,loading:!1,client:c}),E=p[0],s=p[1],r=l.useRef({result:E,mutationId:0,isMounted:!0,client:c,mutation:o,options:i});Object.assign(r.current,{client:c,options:i,mutation:o});var _=l.useCallback(function(t){t===void 0&&(t={});var M=r.current,D=M.options,j=M.mutation,I=b(b({},D),{mutation:j}),d=t.client||r.current.client;!r.current.result.loading&&!I.ignoreResults&&r.current.isMounted&&s(r.current.result={loading:!0,error:void 0,data:void 0,called:!0,client:d});var h=++r.current.mutationId,u=w(I,t);return d.mutate(u).then(function(n){var e,a,v=n.data,m=n.errors,f=m&&m.length>0?new A({graphQLErrors:m}):void 0,C=t.onError||((e=r.current.options)===null||e===void 0?void 0:e.onError);if(f&&C&&C(f,u),h===r.current.mutationId&&!u.ignoreResults){var y={called:!0,loading:!1,data:v,error:f,client:d};r.current.isMounted&&!R(r.current.result,y)&&s(r.current.result=y)}var g=t.onCompleted||((a=r.current.options)===null||a===void 0?void 0:a.onCompleted);return f||g==null||g(n.data,u),n}).catch(function(n){var e;if(h===r.current.mutationId&&r.current.isMounted){var a={loading:!1,error:n,data:void 0,called:!0,client:d};R(r.current.result,a)||s(r.current.result=a)}var v=t.onError||((e=r.current.options)===null||e===void 0?void 0:e.onError);if(v)return v(n,u),{data:void 0,errors:n};throw n})},[]),k=l.useCallback(function(){if(r.current.isMounted){var t={called:!1,loading:!1,client:c};Object.assign(r.current,{mutationId:0,result:t}),s(t)}},[]);return l.useEffect(function(){return r.current.isMounted=!0,function(){r.current.isMounted=!1}},[]),[_,b({reset:k},E)]}var K=function(o){return typeof o=="function"};export{K as i,J as u};
